
<page-header class="bg-cyan-50" title="Gym" />

<mat-tab-group [(selectedIndex)]="selectedTabIndex" (selectedIndexChange)="onTabChange($event)">
  <!-- TAB 1: Client List -->
  <mat-tab label="Gym List">
    <div class="filters-container">
      <div class="filters-left">
        <!-- Search Filter -->
        <mat-form-field appearance="outline" style="width: 300px; margin-right: 10px;">
          <mat-label>Search</mat-label>
          <input matInput placeholder="Search by name or email" [(ngModel)]="searchText" (input)="applyFilters()" />
        </mat-form-field>

        <!-- Status Filter -->
        <mat-form-field appearance="outline" style="width: 200px;">
          <mat-label>Status</mat-label>
          <mat-select [(ngModel)]="statusFilter" (selectionChange)="applyFilters()">
            <mat-option value="">All</mat-option>
            <mat-option value="Active">Active</mat-option>
            <mat-option value="Inactive">Inactive</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <!-- Add Client Button -->
      <div class="filters-right">
        <button mat-flat-button class="add-button" (click)="addGym()">Create New Gym</button>
      </div>
    </div>

    <!-- Data Grid -->
    <mtx-grid
  [data]="filteredList"
  [columns]="columns"
  [loading]="false"
  [columnResizable]="false"
  [multiSelectable]="false"
  [rowSelectable]="false"
  [hideRowSelectionCheckbox]="true"
  [rowHover]="true"
  [rowStriped]="false"
  [showToolbar]="true"
  [toolbarTitle]="'Gym List'"
  [columnHideable]="true"
  [columnSortable]="true"
  [columnPinnable]="true"
  [expandable]="false"
  [pageOnFront]="true"
  [showPaginator]="true"
  [pageSizeOptions]="[5, 10, 50, 100]"
  [pageIndex]="0"
  [pageSize]="5"
  (rowClick)="onRowClick($event)"
></mtx-grid>

  </mat-tab>

  <!-- TAB 2: Client Form -->
<mat-tab label="Gym Details" [disabled]="GymDetailsTabDisabled">
  <mat-card>
    <mat-card-header>
      <mat-card-title>Gym Details</mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form [formGroup]="reactiveForm1"  class="form-field-grid">

        <!-- Gym ID & Name -->
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Gym ID</mat-label>
            <input matInput formControlName="gymId" readonly />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Gym Name</mat-label>
            <input matInput formControlName="name" required />
          </mat-form-field>
        </div>

        <!-- Owner Email & Phone -->
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Owner Email</mat-label>
            <input matInput formControlName="ownerEmail" type="email" required />
            <mat-error *ngIf="reactiveForm1.get('ownerEmail')?.invalid">
              Please enter a valid email
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Phone</mat-label>
            <input matInput formControlName="phone" />
          </mat-form-field>
        </div>       


        <!-- Subscription Status -->
        <div class="form-row">
          <mat-form-field appearance="outline">
            <mat-label>Subscription Status</mat-label>
            <mat-select formControlName="subscriptionStatus" required>
              <mat-option value="active">Active</mat-option>
              <mat-option value="expired">Expired</mat-option>
              <mat-option value="trial">Trial</mat-option>
              <mat-option value="cancelled">Cancelled</mat-option>
            </mat-select>
          </mat-form-field>

           <mat-form-field appearance="outline">
            <mat-label>Subscription Start Date</mat-label>
            <input matInput [matDatepicker]="picker1" formControlName="subscriptionStartDate" required />
            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
            <mat-datepicker #picker1></mat-datepicker>
          </mat-form-field>


          <mat-form-field appearance="outline">
            <mat-label>Subscription End Date</mat-label>
            <input matInput [matDatepicker]="picker2" formControlName="subscriptionEndDate" required />
            <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
            <mat-datepicker #picker2></mat-datepicker>
          </mat-form-field>
        </div>

    
     
         <div class="form-row">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Address Line 1</mat-label>
            <input matInput formControlName="line1" />
          </mat-form-field>
        </div>

        <!-- Address Fields -->
        <div class="form-row">
      
          <mat-form-field appearance="outline">
            <mat-label>Country</mat-label>
            <input matInput formControlName="country" />
          </mat-form-field>

  <mat-form-field appearance="outline">
  <mat-label>State</mat-label>
  <mat-select formControlName="state" (selectionChange)="onStateChange($event.value)">
    <mat-option *ngFor="let state of IndianStateDistList" [value]="state.state">
      {{ state.state }}
    </mat-option>
  </mat-select>
</mat-form-field>

<mat-form-field appearance="outline">
  <mat-label>District</mat-label>
  <mat-select formControlName="district">
    <mat-option *ngFor="let district of filteredDistricts" [value]="district">
      {{ district }}
    </mat-option>
  </mat-select>
</mat-form-field>


           <mat-form-field appearance="outline">
            <mat-label>City</mat-label>
            <input matInput formControlName="city" />
          </mat-form-field>

            <mat-form-field appearance="outline">
            <mat-label>Zip</mat-label>
            <input matInput formControlName="zip" />
          </mat-form-field>
      
        </div>

        <div class="form-row">
           <mat-form-field appearance="outline" >
            <mat-label>Website</mat-label>
            <input matInput formControlName="website" type="url" />
          </mat-form-field>

        </div>


               <div class="upload-card">
  <!-- Image Preview -->
  <div class="image-preview">
    <ng-container *ngIf="reactiveForm1.get('logo')?.value; else placeholder">
      <img [src]="reactiveForm1.get('logo')?.value" width="120px" height="120px" alt="Preview" />
    </ng-container>
    <ng-template #placeholder>
      <div class="placeholder">No logo</div>
    </ng-template>
  </div>

  <!-- Hidden File Input -->
  <input 
    type="file" 
    accept="image/*" 
    (change)="onLogoSelected($event)" 
    #fileInput 
    hidden
  />

  <!-- Upload Button -->
  <button mat-raised-button color="primary" class="upload-btn" (click)="fileInput.click()">
    Upload Logo
  </button>

         </div>     
        <!-- Buttons -->
        <div class="form-buttons" style="margin-top: 20px;">
          <button mat-raised-button type="reset" class="cancel-button"
            (click)="reactiveForm1.reset({ subscriptionStatus: 'active', isTrial: false })"
            style="margin-left: 10px;">
            Cancel
          </button>
          <button (click)="onSubmit()" mat-raised-button class="save-button" type="submit" [disabled]="reactiveForm1.invalid">
            Save
          </button>
        </div>

        <!-- Loader -->
        <div *ngIf="loading" class="loading-overlay">
          <mat-spinner color="accent" aria-label="Loading"></mat-spinner>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</mat-tab>


</mat-tab-group>
